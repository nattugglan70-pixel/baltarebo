<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<title>Utanf√∂r d√∂rren</title>
<style>
  body {
    font-family: 'Arial', sans-serif;
    margin: 0;
    padding: 0;
    text-align: center;
    background: linear-gradient(to bottom, #e0f7fa, #ffffff);
    transition: background 1s;
    color: #004d40;
  }
  h1 {
    font-size: 48px;
    margin-top: 50px;
    letter-spacing: 2px;
  }
  .temp {
    font-size: 90px;
    font-weight: bold;
    margin: 20px 0;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .temp span {
    margin-left: 15px;
    font-size: 80px;
  }
  .update {
    font-size: 20px;
    color: #00796b;
    margin-bottom: 50px;
  }
</style>
</head>
<body>

<h1>Utanf√∂r d√∂rren</h1>
<div class="temp" id="temp">‚Äì ¬∞C <span id="icon">üå°Ô∏è</span></div>
<div class="update" id="update">Uppdateras automatiskt</div>

<script>
// V√§ljer ikon beroende p√• temp
function getWeatherIcon(temp){
  if(temp <= 0) return "‚ùÑÔ∏è";
  if(temp <= 10) return "üß•";
  if(temp <= 20) return "üå§Ô∏è";
  if(temp <= 30) return "‚òÄÔ∏è";
  return "üî•";
}

// Bakgrund baserat p√• temp
function getBackground(temp){
  if(temp <= 0) return "linear-gradient(to bottom, #b3e5fc, #e0f7fa)";
  if(temp <= 10) return "linear-gradient(to bottom, #b2dfdb, #e0f2f1)";
  if(temp <= 20) return "linear-gradient(to bottom, #fff9c4, #fffde7)";
  if(temp <= 30) return "linear-gradient(to bottom, #ffe082, #fff3e0)";
  return "linear-gradient(to bottom, #ff8a65, #ffccbc)";
}

// H√§mtar temp fr√•n API
async function fetchTemperature(){
  try {
    const response = await fetch(
      "https://api.temperatur.nu/tnu_1.17.php?p=karlsbro&cli=githubpage"
    );
    const data = await response.json();
    return data.stations && data.stations[0] && data.stations[0].temp;
  } catch (err) {
    return null;
  }
}

// Uppdaterar sidan med temp
async function updateTemp(){
  const temp = await fetchTemperature();
  const tempElem = document.getElementById("temp");
  const iconElem = document.getElementById("icon");
  
  if(temp !== null){
    tempElem.textContent = temp + " ¬∞C ";
    iconElem.textContent = getWeatherIcon(parseFloat(temp));
    tempElem.appendChild(iconElem);
    document.body.style.background = getBackground(parseFloat(temp));
    
    const now = new Date();
    const h = now.getHours().toString().padStart(2,'0');
    const m = now.getMinutes().toString().padStart(2,'0');
    document.getElementById("update").textContent = 
      "Senast uppdaterad: " + h + ":" + m;
  } else {
    tempElem.textContent = "‚Äì ¬∞C üå°Ô∏è";
    document.getElementById("update").textContent =
      "Kunde inte h√§mta temperatur";
  }
}

// K√∂r direkt och varje 5:e minut
updateTemp();
setInterval(updateTemp, 300000);
</script>

</body>
</html>
